{% for rhost in containers %}
{% for rid, data in profiles.items() %}
{% set host = salt['mc_saltcloud.gen_id'](rhost) %}
{% set id = salt['mc_saltcloud.gen_id'](rid) %}
ms-{{host}}-{{id}}-lxc:
  provider: {{host}}-lxc
  from_container: ubuntu
  backing: lvm
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-dir:
  provider: {{host}}-lxc
  from_container: ubuntu
  backing: dir
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-lvm-sratch:
  provider: {{host}}-lxc
  backing: lvm
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-dir-scratch:
  provider: {{host}}-lxc
  backing: dir
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-mastersalt-lxc:
  provider: {{host}}-lxc
  from_container: ubuntu
  backing: lvm
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud --mastersalt-minion
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-mastersalt-dir:
  provider: {{host}}-lxc
  from_container: ubuntu
  backing: dir
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud --mastersalt-minion
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-mastersalt-lvm-sratch:
  provider: {{host}}-lxc
  backing: lvm
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud --mastersalt-minion
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-mastersalt-dir-scratch:
  provider: {{host}}-lxc
  backing: dir
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud --mastersalt-minion
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}
{% endfor %}
{% endfor %}
# vim:set ft=sls:
