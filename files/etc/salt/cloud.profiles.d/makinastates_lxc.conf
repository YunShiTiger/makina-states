{% for rhost in containers %}
{% set host = salt['mc_saltcloud.gen_id'](rhost) %}
{% for rid, data in profiles.items() %}
{% set id = salt['mc_saltcloud.gen_id'](rid) %}
ms-{{host}}-{{id}}-lvm:
  provider: {{host}}-lxc
  from_container: {{pdata.default_container}}
  backing: lvm
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-{{id}}-lvm-sratch:
  provider: {{host}}-lxc
  image: ubuntu
  backing: lvm
  sudo: True
  size: {{data.size}}
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

{% endfor %}

ms-{{host}}-dir:
  provider: {{host}}-lxc
  from_container: {{pdata.default_container}}
  backing: dir
  sudo: True
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}

ms-{{host}}-dir-scratch:
  provider: {{host}}-lxc
  image: ubuntu
  backing: dir
  sudo: True
  script: {{msr}}/_scripts/boot-salt.sh
  script_args: -C --from-salt-cloud -no-M
  minion:
    master: {{cdata.master}}
    master_port: {{cdata.master_port}}
{% endfor %}
# vim:set ft=sls:
