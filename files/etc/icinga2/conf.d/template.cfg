# MANAGED VIA SALT -- DO NOT EDIT
{% set file = salt['mc_utils.json_load'](file) %}
{% set objects = salt['mc_icinga2.add_configuration_object'](get=True, get_objects_file=file) -%}

{% for object in objects -%}

{%- if 'fromsettings' in object -%}
{# when fromsettings is used, get the object from settings - we can't do this in the sls file in order to save the ram #}
{% set object = salt['mc_utils.json_dump'](salt['mc_icinga2.get_settings_for_object']('objects_definitions', object.fromsettings)) %}
{% set object = salt['mc_utils.json_load'](object) %}
{%- endif -%}

object {{object.type}} "{{object.name}}" {

{%- for key, value in object.attrs.items() -%}
{%     if value is mapping %}
    {{key}} = {
{%-         for kkey, vvalue in value.items() %}
{%-              if vvalue is mapping %}
        "{{kkey}}" = {{vvalue}}
{%-              else %}
        "{{kkey}}" = "{{vvalue}}"
{%-              endif %}
{%-         endfor %}
    }
{%     else %}
    {{key}} = {{value}}
{%     endif %}
{%- endfor %}

}
{% endfor -%}
