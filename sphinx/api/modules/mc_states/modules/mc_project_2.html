

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mc_project_2 / project settings regitry APIV2 &mdash; Makina States 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Makina States 1.0 documentation" href="../../../../index.html"/>
        <link rel="up" title="modules Modules" href="../../index.html"/>
        <link rel="next" title="mc_project / project settings regitry switcher and common functions" href="mc_project.html"/>
        <link rel="prev" title="mc_project_1 / project settings regitry APIV1" href="mc_project_1.html"/> 

  
  <script src="../../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../../index.html" class="icon icon-home"> Makina States
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Custom states modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../api/index.html">api Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html">modules Modules</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="makina_grains.html">makinagrains</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_apache.html">mc_apache / apache httpd functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_apparmor.html">mc_apparmor / apparmor functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_autoupgrade.html">mc_autoupgrade / packages autoupgrade</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_bind.html">mc_bind / named/bind functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_bootstraps.html">mc_bootstraps / bootstraps related registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_burp.html">mc_burp / burp functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_casperjs.html">mc_casperjs / casperjs/npm registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_circus.html">mc_circus / circus functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_compute_node.html">mc_cloud_compute_node / cloud compute node related functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_controller.html">mc_cloud_controller / cloud related variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_docker.html">mc_cloud_docker / docker registry for compute nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_images.html">mc_cloud_images / cloud images release managment &amp; delivery</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_kvm.html">mc_cloud_kvm / kvm registry for compute nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_lxc.html">mc_cloud_lxc / lxc registry for compute nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud.html">mc_cloud / cloud registries &amp; functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_saltify.html">mc_cloud_saltify / cloud related variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cloud_vm.html">mc_cloud_vm / vm registry for compute nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_controllers.html">mc_controllers / controllers related variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_cron.html">mc_cron / cron functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_dbsmartbackup.html">mc_dbsmartbackup / db_smart_backup functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_dbus.html">mc_dbus / dbus functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_dhcpd.html">mc_dhcpd / dhcpd registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_djutils.html">mc_djutils / django helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_dnshelpers.html">mc_dnshelpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_dns.html">mc_dns / dns settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_dumper.html">mc_dumper / Some useful wrappers to dump/load values</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_editor.html">mc_editor / editor registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_env.html">mc_env / env registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_etckeeper.html">mc_etckeeper</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_etherpad.html">mc_etherpad / etherpad functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_fail2ban.html">mc_fail2ban / fail2ban functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_firewalld.html">mc_firewalld / firewalld functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_golang.html">mc_golang / golang registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_grub.html">mc_grub / grub registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_haproxy.html">mc_haproxy / haproxy functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_icinga2.html">mc_icinga2 / icinga functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_icinga.html">mc_icinga / icinga functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_icinga_web2.html">mc_icinga_web2 / icinga_web2 functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_icinga_web.html">mc_icinga_web / icinga_web functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_insserv.html">mc_inssserv / inssserv functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_java.html">mc_java / java registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_kernel.html">mc_kernel / kernel registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ldap.html">mc_ldap / ldap registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_locales.html">mc_locales / locales registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_localsettings.html">mc_localsettings / localsettings variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_locations.html">mc_locations</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_logrotate.html">mc_logrotate / logrotate registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_lxc.html">mc_lxc / lxc registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_macros.html">mc_macros / macros helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_makinastates.html">mc_makinastates</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_memcached.html">mc_memcached / memcached registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_mongodb.html">mc_mongodb / mongodb functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_monitoring.html">mc_monitoring registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ms_iptables.html">mc_ms_iptables / iptables functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_mumble.html">mc_mumble / mumble registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_mvn.html">mc_mvn / mvn registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_mysql.html">mc_mysql / mysql functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_nagvis.html">mc_nagvis / nagvis functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_network.html">mc_network / network registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_nginx.html">mc_nginx / nginx registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_nodejs.html">mc_nodejs / nodejs/npm registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_nodetypes.html">mc_nodetypes / nodetypes registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_nscd.html">mc_nscd.py / ulogd functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ntp.html">mc_ntp / ntp registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_pgsql.html">mc_pgsql / Postgresql related functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_phantomjs.html">mc_phantomjs / phantomjs/npm registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_php.html">mc_php / php registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_pillar.html">mc_pillar / makinastates ext-pillar</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_pkgs.html">mc_pkgs / pkgs registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_pnp4nagios.html">mc_pnp4nagios / pnp4nagios functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_postfix.html">mc_postfix / postfix functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_project_1.html">mc_project_1 / project settings regitry APIV1</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">mc_project_2 / project settings regitry APIV2</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_project.html">mc_project / project settings regitry switcher and common functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_provider.html">mc_provider / provider functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_proxy.html">mc_proxy / proxy registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_psad.html">mc_psad / psad functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_pureftpd.html">mc_pureftpd / pureftpd functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_python.html">mc_python / python registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_rabbitmq.html">mc_rabbitmq / rabbitmq functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_rdiffbackup.html">mc_rdiff-backup / rdiff-backup functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_redis.html">mc_redis / redis functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_remote_pillar.html">mc_remote_pillar / masterless pillar management</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_remote.html">mc_remote / remote execution functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_rsyslog.html">mc_rsyslog / rsyslog functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_rvm.html">mc_rvm / rvm registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_salt.html">mc_salt / salt related helpers</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_screen.html">mc_screen / screen registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_services_managers.html">mc_services_managers / servives managers registries &amp; functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_services.html">mc_services / servives registries &amp; functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_shorewall.html">mc_shorewall / shorewall functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_slapd.html">mc_slapd / slapd registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_snmpd.html">mc_snmpd / snmpd functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ssh.html">mc_ssh / OpenSSH  related functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ssl.html">mc_ssl / ssl registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_state.html">mc_state / module to execute functions on salt</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_supervisor.html">mc_supervisor / supervisor functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_test.html">mc_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_timezone.html">mc_timezone / timezone registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_tomcat.html">mc_tomcat / tomcat functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ubuntugis.html">mc_ubuntugis / ubuntugis registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_ulogd.html">mc_ulogd / ulogd functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_updatedb.html">mc_updatedb / updatedb functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_usergroup.html">mc_usergroup / usergroup registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_utils.html">mc_utils / Some usefull small tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_uwsgi.html">mc_uwsgi / uwsgi functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_vim.html">mc_vim / vim registry</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_virtualbox.html">mc_virtualbox / virtualbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="mc_www.html">mc_www / www registry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../states/index.html">states Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../grains/index.html">grains Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pillars/index.html">pillars Modules</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">Makina States</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">Custom states modules</a> &raquo;</li>
      
          <li><a href="../../index.html">modules Modules</a> &raquo;</li>
      
    <li>mc_project_2 / project settings regitry APIV2</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../../_sources/api/modules/mc_states/modules/mc_project_2.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-mc_states.modules.mc_project_2"></span><div class="section" id="mc-project-2-project-settings-regitry-apiv2">
<span id="module-mc-project-2"></span><h1>mc_project_2 / project settings regitry APIV2<a class="headerlink" href="#mc-project-2-project-settings-regitry-apiv2" title="Permalink to this headline">¶</a></h1>
<p>This is a Corpus Paas reactor, deploy your projects with style, salt style.</p>
<p>This can either:</p>
<blockquote>
<div><ul class="simple">
<li>Deploy locally a project</li>
<li>Deploy remotely a project over ssh (the remote host must have
makina-states installed)</li>
</ul>
</div></blockquote>
<dl class="function">
<dt id="mc_states.modules.mc_project_2.clean_salt_git_commit">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">clean_salt_git_commit</code><span class="sig-paren">(</span><em>directory</em>, <em>commit=True</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.clean_salt_git_commit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.deploy">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">deploy</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.deploy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deploy a project</p>
<p>Only run install step:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local -ldebug mc_project.deploy &lt;name&gt; only=install
</pre></div>
</div>
<p>Run only one or certain install step:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local -ldebug mc_project.deploy\
        &lt;name&gt; only=install only_steps=00_foo
salt-call --local -ldebug mc_project.deploy\
        &lt;name&gt; only=install only_steps=00_foo,02_bar
</pre></div>
</div>
<p>Only run install &amp; fixperms step:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local -ldebug mc_project.deploy &lt;n&gt; only=install,fixperms
</pre></div>
</div>
<p>Deploy entirely (this is what is run whithin the git hook):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local -ldebug mc_project.deploy &lt;name&gt;
</pre></div>
</div>
<p>Skip a particular step:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local -ldebug mc_project.deploy &lt;name&gt;\
        skip_release_sync=True skip_archive=True skip_notify=True
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.get_configuration">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">get_configuration</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.get_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a configuration data structure needed data for
the project API macros and configurations functions
project API 2</p>
<dl class="docutils">
<dt>name</dt>
<dd>name of the project</dd>
<dt>remote_less</dt>
<dd>Does the project use local remotes (via git hooks) for users
to push code inside remotes and have the local working copy
synchronized with those remotes before deploy.
Default to True, set to False to use local remotes
If the project directory .git folder exists, and there
is no local remote created, the local remotes feature
will also be disabled</dd>
<dt>fqdn</dt>
<dd>fqdn of the box</dd>
<dt>minion_id</dt>
<dd>minion_id of the box</dd>
<dt>default_env</dt>
<dd>environnemt to run into (may be dev|prod, better
to set a grain see bellow)</dd>
<dt>project_root</dt>
<dd>where to install the project,</dd>
<dt>git_root</dt>
<dd>root dir for git repositories</dd>
<dt>user</dt>
<dd>system project user</dd>
<dt>groups</dt>
<dd>system project user groups, first group is main</dd>
<dt>defaults</dt>
<dd>arbitrary data mapping for this project to use in states.
It will be accessible throught the get_configuration().data var</dd>
<dt>env_defaults</dt>
<dd>per environment (eg: prod|dev) specific defaults data to override or
merge inside the defaults one</dd>
<dt>os_defaults</dt>
<dd>per os (eg: Ubuntu/Debian) specific defaults data to override or merge
inside the defaults one</dd>
<dt>only_install</dt>
<dd>Only run the install step (make the others skipped)</dd>
<dt>skip_archive</dt>
<dd>Skip the archive step</dd>
<dt>skip_release_sync</dt>
<dd>Skip the release_sync step</dd>
<dt>skip_install</dt>
<dd>Skip the install phase</dd>
<dt>skip_rollback</dt>
<dd>Skip the rollback step if any</dd>
<dt>skip_notify</dt>
<dd>Skip the notify step if any</dd>
</dl>
<p>Any other kwarg is added to the data dict.</p>
<p>Internal variables reference</p>
<blockquote>
<div><dl class="docutils">
<dt>pillar_root</dt>
<dd>pillar local dir</dd>
<dt>salt_root</dt>
<dd>salt local dir</dd>
<dt>archives_root</dt>
<dd>archives directory</dd>
<dt>data_root</dt>
<dd>persistent data root</dd>
<dt>project_git_root</dt>
<dd>project local git dir</dd>
<dt>pillar_git_root</dt>
<dd>pillar local git dir</dd>
<dt>nodata</dt>
<dd>do not compute data</dd>
<dt>data</dt>
<dd>The final mapping where all defaults will be mangled.
If you want to add extra parameters in the configuration, you d
better have to add them to defaults.</dd>
<dt>force_reload</dt>
<dd>if the project configuration is already present in the context,
reload it anyway</dd>
<dt>sls_includes</dt>
<dd>includes to add to the project top includes statement</dd>
<dt>no_default_includes</dt>
<dd>Do not add salt_minon &amp; other bases sls
like ssh to default includes</dd>
<dt>rollback</dt>
<dd>FLAG: do we rollback at the end of all processes</dd>
</dl>
</div></blockquote>
<p>You can override the non read only default variables
by pillar/grain like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt grain.setval makina-projects.foo.url &#39;http://goo/goo.git
salt grain.setval makina-projects.foo.default_env prod
</pre></div>
</div>
<p>You can override the non read only default arbitrary attached defaults
by pillar/grain like:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>/srv/projects/foo/pillar/init.sls:

makina-projects.foo.data.conf_port = 1234
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.get_configuration_item">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">get_configuration_item</code><span class="sig-paren">(</span><em>project</em>, <em>item=&lt;object object&gt;</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.get_configuration_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an item, maybe filtered or all the config</p>
<p>in the form:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>{key: &lt;itemKey or &#39;cfg&#39;&gt;, item: VALUE, cfg: &lt;Whole config dict&gt;}
</pre></div>
</div>
<p>CLI examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local                mc_project_2.get_configuration_item eee git_deploy_hook
salt-call --local                mc_project_2.get_configuration_item eee
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.get_project">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">get_project</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.get_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias of get_configuration for convenience</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.init_pillar_dir">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">init_pillar_dir</code><span class="sig-paren">(</span><em>directory</em>, <em>init_data=None</em>, <em>user=None</em>, <em>group=None</em>, <em>project=None</em>, <em>commit_all=False</em>, <em>do_push=False</em>, <em>remote_less=False</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.init_pillar_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a basic versionned pillar directory</p>
<dl class="docutils">
<dt>directory</dt>
<dd>directory to execute into</dd>
<dt>user</dt>
<dd>user to exec commands as and for new files</dd>
<dt>group</dt>
<dd>group for new files</dd>
<dt>commit_all</dt>
<dd>do we do a final git add/commit</dd>
<dt>do_push</dt>
<dd>do we do a final push</dd>
<dt>project</dt>
<dd>project name</dd>
<dt>init_data</dt>
<dd>configuration options in the corpus format (see get_configuration)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.init_project">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">init_project</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.init_project" title="Permalink to this definition">¶</a></dt>
<dd><p>See common args to feed the neccessary variables to set a project
You will need at least:</p>
<blockquote>
<div><ul class="simple">
<li>A name</li>
<li>A type</li>
<li>The pillar git repository url</li>
<li>The project &amp; salt git repository url</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.init_remote_structure">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">init_remote_structure</code><span class="sig-paren">(</span><em>host</em>, <em>project</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.init_remote_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a remote project structure over ssh</p>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.init_remote_structure host.fr &lt;project&gt;
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.init_repo">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">init_repo</code><span class="sig-paren">(</span><em>working_copy</em>, <em>user=None</em>, <em>group=None</em>, <em>ret=None</em>, <em>bare=True</em>, <em>init_salt=False</em>, <em>init_pillar=False</em>, <em>init_data=None</em>, <em>project=None</em>, <em>remote_host=None</em>, <em>cfg=None</em>, <em>remote_less=False</em>, <em>api_version='2'</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.init_repo" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an empty git repository, either bare or a working copy</p>
<p>This can be either:</p>
<blockquote>
<div><ul class="simple">
<li>a basic corpus-salt base project template</li>
<li>a pillar repo (containing an init.sls)</li>
<li>an enmpty directory (containing an empty .empty file just
for git repo init)</li>
</ul>
</div></blockquote>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.init_repo /foo
salt-call --local mc_project.init_repo /foo bare=true
salt-call --local mc_project.init_repo /foo init_salt=True
salt-call --local mc_project.init_repo /foo init_pillar=True
salt-call --local mc_project.init_repo /foo bare=true init_salt=True
salt-call --local mc_project.init_repo /foo bare=true init_pillar=True
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.init_salt_dir">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">init_salt_dir</code><span class="sig-paren">(</span><em>directory</em>, <em>user=None</em>, <em>group=None</em>, <em>commit_all=False</em>, <em>do_push=False</em>, <em>project=None</em>, <em>init_data=None</em>, <em>remote_less=False</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.init_salt_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a basic corpus project directory</p>
<dl class="docutils">
<dt>directory</dt>
<dd>directory to execute into</dd>
<dt>user</dt>
<dd>user to exec commands as and for new files</dd>
<dt>group</dt>
<dd>group for new files</dd>
<dt>commit_all</dt>
<dd>do we do a final git add/commit</dd>
<dt>do_push</dt>
<dd>do we do a final push</dd>
<dt>project</dt>
<dd>project name</dd>
<dt>init_data</dt>
<dd>configuration options in the corpus format (see get_configuration)</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.init_ssh_user_keys">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">init_ssh_user_keys</code><span class="sig-paren">(</span><em>user</em>, <em>failhard=False</em>, <em>ret=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.init_ssh_user_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy root keys from root to a user
to allow user to share the same key than root to clone distant repos.
This is useful in vms (local PaaS vm)</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.install">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">install</code><span class="sig-paren">(</span><em>name</em>, <em>only_steps=None</em>, <em>task_mode=False</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.install" title="Permalink to this definition">¶</a></dt>
<dd><p>You can filter steps to run with only_steps
All sls in .salt which are not special or tasks (beginning with tasks
will be executed)</p>
<p>eg:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt mc_project.deploy only=install onlystep=00_foo,001_bar
salt mc_project.deploy only=install onlystep=00_foo
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.link">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">link</code><span class="sig-paren">(</span><em>names</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.link" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the link wired in salt folders (pillar &amp; salt)
&amp; register the pillar in pillar top</p>
<dl class="docutils">
<dt>name</dt>
<dd>list of project(s) separated by commas</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.link_into_root">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">link_into_root</code><span class="sig-paren">(</span><em>name</em>, <em>ret</em>, <em>link</em>, <em>target</em>, <em>do_link=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.link_into_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Link a salt managed directory into salt root</p>
<p>This takes care of not leaving a dangling symlink</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.link_pillar">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">link_pillar</code><span class="sig-paren">(</span><em>names</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.link_pillar" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the link wired in pillar folder
&amp; register the pillar in pillar top</p>
<dl class="docutils">
<dt>name</dt>
<dd>list of project(s) separated by commas</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.link_salt">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">link_salt</code><span class="sig-paren">(</span><em>names</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.link_salt" title="Permalink to this definition">¶</a></dt>
<dd><p>Link a salt managed directory into salt root
This takes care of not leaving a dangling symlink</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.load_sample">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">load_sample</code><span class="sig-paren">(</span><em>cfg</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.load_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the project PILLAR.sample back to the cfg
configuration dict</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.orchestrate">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">orchestrate</code><span class="sig-paren">(</span><em>host</em>, <em>project</em>, <em>init=True</em>, <em>init_project=None</em>, <em>init_pillar=None</em>, <em>init_remote=True</em>, <em>sync=True</em>, <em>sync_project=None</em>, <em>sync_pillar=None</em>, <em>refresh=True</em>, <em>refresh_pillar=None</em>, <em>refresh_project=None</em>, <em>deploy=True</em>, <em>pillar_origin=None</em>, <em>pillar_rev=None</em>, <em>origin=None</em>, <em>rev=None</em>, <em>pre_init_hook=None</em>, <em>post_init_hook=None</em>, <em>pre_init_remote_hook=None</em>, <em>post_init_remote_hook=None</em>, <em>pre_sync_hook=None</em>, <em>deploy_fun='mc_project.remote_deploy'</em>, <em>deploy_kwarg=None</em>, <em>deploy_args=None</em>, <em>post_sync_hook=None</em>, <em>pre_hook=None</em>, <em>post_hook=None</em>, <em>only=None</em>, <em>only_steps=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.orchestrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Orchestrate a project deployment, remotely</p>
<p>Note:</p>
<blockquote>
<div>a project is composed by it&#8217;s code &amp; deployment recipe (.salt)
and it&#8217;s pillar.</div></blockquote>
<p>This:</p>
<blockquote>
<div><ul class="simple">
<li>Run the pre init hook if any</li>
<li>initiliazes &amp; prepare the code locally</li>
<li>Run the post init hook if any</li>
<li>Run the pre init remote hook if any</li>
<li>May initiliazes the remote project structure</li>
<li>Run the post init remote hook if any</li>
<li>Run the pre sync hook if any</li>
<li>Sync the code to remote buffer directories</li>
<li>Sync the remote deployment directories (pillar &amp; project)</li>
<li>Run the post sync hook if any</li>
<li>Run the pre deploy hook if any</li>
<li>Run the deployment procedure (salt-call mc_project.deploy dance)</li>
<li>Run the post deploy hook if any</li>
</ul>
</div></blockquote>
<dl class="docutils">
<dt>The deployed code will at first be initialized:</dt>
<dd><dl class="first last docutils">
<dt>project code is initialized as either:</dt>
<dd><ul class="first last">
<li><p class="first">from an empty structure (shell helloworld)</p>
</li>
<li><p class="first">from <strong>git</strong>:</p>
<blockquote>
<div><dl class="docutils">
<dt>origin</dt>
<dd><p class="first last">git url</p>
</dd>
<dt>rev</dt>
<dd><p class="first last">git remote tag/branch/changeset</p>
</dd>
</dl>
</div></blockquote>
</li>
<li><p class="first">from an empty structure (shell helloworld)</p>
</li>
</ul>
</dd>
<dt>pillar code is initialized as either:</dt>
<dd><ul class="first last">
<li><p class="first">from an empty structure (shell helloworld)</p>
</li>
<li><p class="first">from <strong>git</strong>:</p>
<blockquote>
<div><dl class="docutils">
<dt>pillar_origin</dt>
<dd><p class="first last">git url</p>
</dd>
<dt>pillar_rev</dt>
<dd><p class="first last">git remote tag/branch/changeset</p>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</dd>
</dl>
<p>If the urls were not specified, but the git repositories
present in the local directories are valid, they will
be deployed as-is.</p>
<p>If the git repositories have a valid remote, the sync step
will use it, even if the &#8220;origin/pillar_origin&#8221; were not
specified explicitly</p>
<dl class="docutils">
<dt>host</dt>
<dd>host where to deploy</dd>
<dt>project</dt>
<dd>project to deploy onto (name)</dd>
<dt>init/init_project/init_pillar</dt>
<dd>do we do the full init step
do we do the init_project step (overrides init).
do we do the init_pillar step (overrides init).</dd>
<dt>init_remote</dt>
<dd>do we do the init_remote step</dd>
<dt>origin/pillar_origin</dt>
<dd>url of the pillar to deploy if any (if None: empty pillar)</dd>
<dt>rev/pillar_rev</dt>
<dd>changeset if the project/pillar is from a git url (master)</dd>
<dt>sync/sync_project/sync_pillar</dt>
<dd>do we do the full sync step.
do we do the sync_project step (overrides sync).
do we do the sync_pillar step (overrides sync)</dd>
<dt>refresh/refresh_project/refresh_pillar</dt>
<dd>do we update the code prior to sync.
do we do the refresh_project step (overrides refresh_project).
do we do the refresh_project step (overrides refresh)</dd>
<dt>deploy</dt>
<dd>do we do the deploy step</dd>
<dt>deploy_args</dt>
<dd>any extra deploy/run_task positional argument</dd>
<dt>deploy_kwarg</dt>
<dd>any extra deploy/run_task extra argument</dd>
<dt>pre_init_hook/post_init_hook/    pre_init_remote_hook/post_init_remote_hook/    pre_sync_hook/post_sync_hook/    pre_hook/post_hook</dt>
<dd>deployment hook (see above lifecycle explaination &amp; hook spec)</dd>
<dt>only/only_steps</dt>
<dd>mc_project.deploy deploy limits arguments(if any)</dd>
</dl>
<p>An hook is a salt function, in any module with the following signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>def hook(host, project, opts, **kw)::
    print(&quot;hourray&quot;)
</pre></div>
</div>
<p>Making in a execution module, /srv/salt/_module/foo.py:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>def hook(host, project, opts, **kw)::
    print(&quot;Called on {0}&quot;.format(host))
</pre></div>
</div>
<p>Can be called like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.orchestrate h proj init_hook=foo.hook
</pre></div>
</div>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.orchestrate host.fr &lt;project&gt;\
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
salt-call --local mc_project.orchestrate host.fr &lt;project&gt;\
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;\
        rev=stable\
        pillar_origin=&quot;https://github.com/mak/corpus-pillar.git&quot;\
        rev=stable
salt-call --local mc_project.orchestrate host.fr &lt;project&gt;\
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
salt-call --local mc_project.orchestrate host.fr &lt;project&gt;\
        deploy_args=[&#39;a&#39;] \
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
salt-call --local mc_project.orchestrate host.fr &lt;project&gt;\
        deploy_kwarg={&#39;myparam&#39;: &#39;a&#39;} \
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.orchestrate_task">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">orchestrate_task</code><span class="sig-paren">(</span><em>host</em>, <em>project</em>, <em>task</em>, <em>init=True</em>, <em>init_project=None</em>, <em>init_pillar=None</em>, <em>init_remote=True</em>, <em>sync=True</em>, <em>sync_project=None</em>, <em>sync_pillar=None</em>, <em>refresh=True</em>, <em>refresh_pillar=None</em>, <em>refresh_project=None</em>, <em>deploy=True</em>, <em>deploy_args=None</em>, <em>deploy_kwarg=None</em>, <em>pillar_origin=None</em>, <em>pillar_rev=None</em>, <em>origin=None</em>, <em>rev=None</em>, <em>pre_init_hook=None</em>, <em>post_init_hook=None</em>, <em>pre_init_remote_hook=None</em>, <em>post_init_remote_hook=None</em>, <em>pre_sync_hook=None</em>, <em>post_sync_hook=None</em>, <em>pre_hook=None</em>, <em>post_hook=None</em>, <em>only=None</em>, <em>only_steps=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.orchestrate_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Orchestrate a project through mc_project._orchestrate and use
mc_project.remote_task &lt;TASK NAME&gt;</p>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.orchestrate_task host.fr &lt;project&gt; task_make_users \
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
salt-call --local mc_project.orchestrate host.fr &lt;project&gt; make_users\
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot; task_make_users\
        rev=stable\
        pillar_origin=&quot;https://github.com/mak/corpus-pillar.git&quot; task_make_users\
        rev=stable
salt-call --local mc_project.orchestrate host.fr &lt;project&gt; task_make_users\
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
salt-call --local mc_project.orchestrate host.fr &lt;project&gt; task_make_users\
        deploy_args=[&#39;a&#39;] \
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
salt-call --local mc_project.orchestrate host.fr &lt;project&gt; task_make_users\
        deploy_kwarg={&#39;myparam&#39;: &#39;a&#39;} \
        origin=&quot;https://github.com/makinacorpus/corpus-pgsql.git&quot;
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.push_changesets_in">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">push_changesets_in</code><span class="sig-paren">(</span><em>directory</em>, <em>remote='origin'</em>, <em>branch='master:master'</em>, <em>opts=''</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.push_changesets_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper to git push</p>
<blockquote>
<div><dl class="docutils">
<dt>directory</dt>
<dd>directory where to act on</dd>
<dt>user</dt>
<dd>user to push as</dd>
<dt>branch</dt>
<dd>branch part of the git command</dd>
<dt>remote</dt>
<dd>remote to push to</dd>
<dt>opts</dt>
<dd>&#8216;origin&#8217;,
opts to give</dd>
</dl>
</div></blockquote>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local  mc_project.push_changesets_in /foo
salt-call --local  mc_project.push_changesets_in /foo opts=&quot;-f&quot;
salt-call --local  mc_project.push_changesets_in /foo opts=&quot;-f&quot;
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.remote_deploy">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">remote_deploy</code><span class="sig-paren">(</span><em>host</em>, <em>project</em>, <em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.remote_deploy" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a deployment task, remotely</p>
<dl class="docutils">
<dt>host</dt>
<dd>host to deploy onto</dd>
<dt>project</dt>
<dd>project to deploy</dd>
<dt>deploy_kwarg</dt>
<dd>deploy kwargs</dd>
<dt>deploy_args</dt>
<dd>deploy arguments</dd>
<dt>deploy_only_steps/only_steps</dt>
<dd>set only_steps kwarg (shortcut)</dd>
<dt>deploy_only/only</dt>
<dd>set only kwarg (shortcut)</dd>
<dt>salt_function</dt>
<dd>salt deploy function (one of: mc_project.deploy/mc_project.run_task)</dd>
</dl>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.remote_deploy                 host.fr &lt;project&gt;
salt-call --local mc_project.remote_deploy                 host.fr &lt;project&gt; only=install,fixperms
salt-call --local mc_project.remote_deploy                 host.fr &lt;project&gt; only=install,fixperms only_steps=0.sls
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.remote_project_hook">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">remote_project_hook</code><span class="sig-paren">(</span><em>hook</em>, <em>host</em>, <em>project</em>, <em>opts</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.remote_project_hook" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an hook</p>
<p>An hook is a salt function, in any module with the following signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>def hook(host, project, opts, **kw)::
    print(&quot;hourray&quot;)
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.remote_run_task">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">remote_run_task</code><span class="sig-paren">(</span><em>host</em>, <em>project</em>, <em>task=None</em>, <em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.remote_run_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a task from the .salt directory, remotely</p>
<p>Task can be either given as a kwarg or the first positional argument.</p>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.remote_run_task                 host.fr &lt;project&gt; task=task_helloworld.sls
salt-call --local mc_project.remote_run_task                 host.fr &lt;project&gt; task_helloworld.sls
salt-call --local mc_project.remote_run_task                 host.fr &lt;project&gt; task_helloworld.sls a=b
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.remote_task">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">remote_task</code><span class="sig-paren">(</span><em>host</em>, <em>project</em>, <em>*args</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.remote_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias to remote_run_task</p>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.remote_task                 host.fr &lt;project&gt; task=task_helloworld.sls
salt-call --local mc_project.remote_task                 host.fr &lt;project&gt; task_helloworld.sls
salt-call --local mc_project.remote_task                 host.fr &lt;project&gt; task_helloworld.sls a=b
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.remove_path">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">remove_path</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.remove_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a path.</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.report">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">report</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.report" title="Permalink to this definition">¶</a></dt>
<dd><p>Get connection details &amp; projects report</p>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.report
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.rollback">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">rollback</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the rollback corpus step</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.rotate_archives">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">rotate_archives</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.rotate_archives" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the rotate_archives corpus step</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.run_task">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">run_task</code><span class="sig-paren">(</span><em>name</em>, <em>only_steps</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.run_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one or more tasks inside a project context.</p>
<p>You can filter steps to run with only_steps</p>
<p>All sls in <code class="docutils literal"><span class="pre">.salt</span></code> which are a task (all files beginning with task_ will be searched
and the one matching only_steps (string or list) will be executed)</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.set_configuration">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">set_configuration</code><span class="sig-paren">(</span><em>name</em>, <em>cfg=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.set_configuration" title="Permalink to this definition">¶</a></dt>
<dd><p>set or update a local (grains) project configuration</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.sync_git_directory">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">sync_git_directory</code><span class="sig-paren">(</span><em>directory</em>, <em>origin=None</em>, <em>rev=None</em>, <em>sync_remote='sync'</em>, <em>refresh=False</em>, <em>local_branch=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.sync_git_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Agressively sync a git working copy with its remote</p>
<dl class="docutils">
<dt>directory</dt>
<dd>directory where to act</dd>
<dt>origin</dt>
<dd>remote origin &lt;url&gt;</dd>
<dt>rev</dt>
<dd>changeset to deploy</dd>
<dt>local_branch</dt>
<dd>local branch to set to</dd>
<dt>sync_remote</dt>
<dd>name of the remote</dd>
<dt>refresh</dt>
<dd>if the working copy exists, force the git pull dance</dd>
</dl>
<p>CLI Examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local \
        mc_project.sync_git_directory /foo origin=git://foo rev=develop
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.sync_hooks_for_all">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">sync_hooks_for_all</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.sync_hooks_for_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Get connection details &amp; projects report</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.sync_modules">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">sync_modules</code><span class="sig-paren">(</span><em>name</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.sync_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Install custom modules to the salt modules directory
in the global module dir,</p>
<p>Note: we install two symlinks to provide room for overlapping modules
eg: project1/project/.salt/_modules/foo.py:bar can be called:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call foo.bar()
salt-call foo_foo.bar()
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.sync_remote_working_copy">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">sync_remote_working_copy</code><span class="sig-paren">(</span><em>host</em>, <em>directory</em>, <em>remote_directory=None</em>, <em>remote_local_copy=None</em>, <em>lremote=None</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.sync_remote_working_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>CLI examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>salt-call --local mc_project.sync_remote_working_copy\
        a.fr /srv/remote-projects/a.fr
salt-call --local mc_project.sync_remote_working_copy\
        a.fr /srv/remote-projects/a.fr /otherdir
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.sync_working_copy">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">sync_working_copy</code><span class="sig-paren">(</span><em>wc</em>, <em>rev=None</em>, <em>ret=None</em>, <em>origin=None</em>, <em>reset=False</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.sync_working_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Synchronnze a directory with it&#8217;s git remote</p>
<dl class="docutils">
<dt>directory</dt>
<dd>directory to execute into</dd>
<dt>reset</dt>
<dd>force sync with remote</dd>
<dt>user</dt>
<dd>user to exec commands as and for new files</dd>
<dt>rev</dt>
<dd>force rev to reset to</dd>
<dt>origin</dt>
<dd>origin to sync with</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.uncache_project">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">uncache_project</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.uncache_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Uncache a configuration after an initial load
either by it&#8217;s name or by its structure</p>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.unlink">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">unlink</code><span class="sig-paren">(</span><em>names</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.unlink" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the link wired in salt folders (pillar &amp; salt)</p>
<dl class="docutils">
<dt>name</dt>
<dd>list of project(s) separated by commas</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.unlink_pillar">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">unlink_pillar</code><span class="sig-paren">(</span><em>names</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.unlink_pillar" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the link wired in pillar folder
&amp; unregister the pillar in pillar top</p>
<dl class="docutils">
<dt>name</dt>
<dd>list of project(s) separated by commas</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.unlink_salt">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">unlink_salt</code><span class="sig-paren">(</span><em>names</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.unlink_salt" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the link wired in salt folder
&amp; unregister the pillar in pillar top</p>
<dl class="docutils">
<dt>name</dt>
<dd>list of project(s) separated by commas</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mc_states.modules.mc_project_2.working_copy_in_initial_state">
<code class="descclassname">mc_states.modules.mc_project_2.</code><code class="descname">working_copy_in_initial_state</code><span class="sig-paren">(</span><em>wc</em>, <em>**kw</em><span class="sig-paren">)</span><a class="headerlink" href="#mc_states.modules.mc_project_2.working_copy_in_initial_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a directory is at the first git commit
from this system</p>
<dl class="docutils">
<dt>wc</dt>
<dd>where to execute</dd>
<dt>user</dt>
<dd>user to act with</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mc_project.html" class="btn btn-neutral float-right" title="mc_project / project settings regitry switcher and common functions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mc_project_1.html" class="btn btn-neutral" title="mc_project_1 / project settings regitry APIV1" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014 -&gt; 2017, Mathieu Le Marec Pasquet, Régis Leroy &amp; Makina Corpus folks.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>