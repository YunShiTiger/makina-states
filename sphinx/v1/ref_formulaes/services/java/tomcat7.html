

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tomcat configuration &mdash; Makina States 1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Makina States 1.0 documentation" href="../../../../index.html"/>
        <link rel="up" title="Java services" href="index.html"/>
        <link rel="next" title="Mail services" href="../mail/index.html"/>
        <link rel="prev" title="Solr4 configuration" href="solr4.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../../../index.html" class="fa fa-home"> Makina States</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="simple">
</ul>
<ul class="simple">
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/index.html">Custom states modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/modules/index.html">Execution modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/states/index.html">States modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/grains/index.html">makina-states grains modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../api/api/index.html">Api  modules</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Makina-states V1 documentation (OBSOLETE)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../index.html#usage">Usage</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html#reference">Reference</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../../index.html">Makina States</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../../index.html">Makina-states V1 documentation (OBSOLETE)</a> &raquo;</li>
      
          <li><a href="../../../ref_index.html">Reference</a> &raquo;</li>
      
          <li><a href="../../index.html">Makina-states Formulaes</a> &raquo;</li>
      
          <li><a href="../index.html">Services</a> &raquo;</li>
      
          <li><a href="index.html">Java services</a> &raquo;</li>
      
    <li>Tomcat configuration</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../../../_sources/v1/ref_formulaes/services/java/tomcat7.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="tomcat-configuration">
<h1>Tomcat configuration<a class="headerlink" href="#tomcat-configuration" title="Permalink to this headline">¶</a></h1>
<p>By default, we will use the java6 oracle jdk jvm.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>makina-states.services.java.tomcat7:
     java_home&#39;: /usr/lib/jvm/java-6-oracle
 users:
   admin:
     password: {{ password }}
     roles&#39;: [&#39;admin&#39;, &#39;manager&#39;]
</pre></div>
</div>
<div class="section" id="available-default-settings">
<h2>AVAILABLE DEFAULT SETTINGS<a class="headerlink" href="#available-default-settings" title="Permalink to this headline">¶</a></h2>
<p>You can override default settings in pillar via the mc_states.tomcat module, please look its relative doc.</p>
</div>
<div class="section" id="custom-configuration-blocks">
<h2>CUSTOM CONFIGURATION BLOCKS<a class="headerlink" href="#custom-configuration-blocks" title="Permalink to this headline">¶</a></h2>
<p>Thanks to file.blockreplace + file.accumulated, you can also add on the fly raw tomcat configuration blocks.
Custom configuration blocks have been wired on those files:</p>
<blockquote>
<div><ul class="simple">
<li>server.xml</li>
<li>context.xml</li>
<li>web.xml</li>
<li>logging.properties</li>
<li>{{ locs.conf_dir }}/default/tomcat7 (practical to add
JAVA_OPTS addition from other sls (eg adding solr datadir &amp; home properties)</li>
<li>catalina.properties</li>
</ul>
</div></blockquote>
<p>See at the end of this state file for the appropriate blockreplace to use
in your case and where those block are located in the aforementioned files.
What you will need is just to make a file.accumulated requirin the appropriate
file.blockreplace ID to add your configuration block.</p>
</div>
<div class="section" id="exposed-state-orchestration-hooks">
<h2>Exposed state orchestration hooks<a class="headerlink" href="#exposed-state-orchestration-hooks" title="Permalink to this headline">¶</a></h2>
<p>Hooks (in order):</p>
<dl class="docutils">
<dt>tomcat-pre-install-hook</dt>
<dd>before tomcat installation</dd>
<dt>tomcat-post-install-hook</dt>
<dd>after tomcat installation</dd>
<dt>tomcat-pre-restart-hook</dt>
<dd>before tomcat restart (after install)</dd>
<dt>tomcat-pre-blocks-hook:</dt>
<dd>before applying block replaces in configuration files</dd>
<dt>tomcat-post-restart-hook</dt>
<dd>after tomcat restart</dd>
</dl>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../mail/index.html" class="btn btn-neutral float-right" title="Mail services">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="solr4.html" class="btn btn-neutral" title="Solr4 configuration"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014 -&gt; 2017, Mathieu Le Marec Pasquet, Régis Leroy &amp; Makina Corpus folks.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../../',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>